After doing a lot of calculations and having spent many hours analyzing the data, you were able to find a solution. For this you had to build a large structure right on the spot - you could not move the table. Having installed the "Book Holder" directly above the table and 4 "Ancient Holders" with the "Ancient Eyes" at the edges you were able to track and transfer the liberated magic to the books... But not always successfully. With a 20% chance, you will not succeed. But if you succeed - do not rush to rejoice. On the received enchantments there can be "Curse of Vanishing" or "Curse of Binding"...
Enchantment Control
The randomness factor is not what the real thaumaturge seeks. He must be absolutely sure of his success or failure. If the chance of transferring the spell can still be reconciled, then with a curse of loss - never. We need to find a way to get rid of this... "Randomness"...
You expected that it would be much easier. To completely get rid of the negative effect of transferring spells, you had to use the power of a primordial pearl, and not even one... The resulting "Infinity Spheres", as you dubbed them, should be placed on the "Pillars of Creation" by placing them around the edges. Also you will need to transfer "Ancient Holders" and "Ancient Eyes". By combining everything into one design. The resulting design will transfer any enchantments to a book located in the "Book Holder". In this case, if there was a "Curse of Vanishing" or "Curse of Binding", it will be deleted.
Teleportator
Watching the Endermen and his, seemingly, spontaneous teleports, you found that they are more than not accidental - he completely controls them. And you came up with the idea of creating controlled teleports in space. But since by nature you are not enderman, and you can't implant yourself with an organ responsible for this, it is simply unrealistic, then it will be necessary to create a mechanism that mimics this...